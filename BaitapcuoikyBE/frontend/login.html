<!DOCTYPE html>
<html>
<head>
    <title>Đăng nhập</title>
    <link rel="stylesheet" href="style.css">
    <script src="main.js"></script>
</head>
<body>
    <div class="container" style="max-width: 400px; margin-top: 100px;">
        <h2 style="text-align: center;">Đăng Nhập</h2>
        <input id="email" type="text" placeholder="Email (admin@shop.test / user@shop.test)" value="user@shop.test">
        <input id="password" type="password" placeholder="Mật khẩu (Admin@123 / User@123)" value="User@123">
        <button onclick="login()" style="width: 100%;">Đăng Nhập</button>
        <p id="msg" style="color: red; text-align: center;"></p>
    </div>

    <script>
    async function login() {
        const email = document.getElementById("email").value;
        const pw = document.getElementById("password").value;

        try {
            const res = await fetch(API_BASE + "/auth/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email: email, password: pw })
            });

            const data = await res.json();

            if (!res.ok) {
                document.getElementById("msg").innerText = data.message || "Đăng nhập thất bại!";
                return;
            }

            // LƯU Ý: Lưu cả Token và UserId
            saveAuthData(data.token, data.userid);

            if (data.role === "Admin") window.location.href = "products.html";
            else window.location.href = "create-order.html";

        } catch (e) {
            document.getElementById("msg").innerText = "Lỗi kết nối server!";
        }
    }
    </script>
</body>
</html>