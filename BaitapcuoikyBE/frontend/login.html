<!DOCTYPE html>
<html>
<head>
    <title>Đăng nhập</title>
    <link rel="stylesheet" href="style.css">
    <script src="main.js"></script>
</head>

<body>
    <div class="container login-container">
        <h2>Đăng Nhập</h2>
        
        <input id="email" type="text" placeholder="Email" value="user@shop.test">
        <input id="password" type="password" placeholder="Mật khẩu" value="User@123">

        <button onclick="login()" style="width: 100%;">Đăng Nhập</button>

        <p id="msg" style="color:red; text-align:center;"></p>
    </div>

    <script>
    async function login() {
        const email = document.getElementById("email").value;
        const pw = document.getElementById("password").value;

        document.getElementById("msg").innerText = "";

        try {
            const res = await fetch(API_BASE + "/auth/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email: email, password: pw })
            });

            const data = await res.json();

            // Nếu sai login
            if (!res.ok) {
                document.getElementById("msg").innerText =
                    data.message || "Sai email hoặc mật khẩu!";
                return;
            }

            // LƯU TOKEN – ROLE – USERID
            saveAuthData(data.token, data.role, data.userid);

            // Chuyển hướng theo role
            if (data.role === "Admin") 
                window.location.href = "products.html";
            else 
                window.location.href = "create-order.html";

        } catch (e) {
            document.getElementById("msg").innerText = "Không kết nối được server!";
        }
    }
    </script>
</body>
</html>
