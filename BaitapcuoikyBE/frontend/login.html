<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link rel="stylesheet" href="style.css"> 
    <script src="main.js"></script>
</head>
<body>
    <div class="container login-container">
        <h2>Đăng Nhập</h2>
        <input id="email" placeholder="Email" type="text" required><br> 
        <input id="password" type="password" placeholder="Mật khẩu" required><br>
        <button onclick="login()">Đăng Nhập</button>
        <p id="msg"></p>
    </div>
    
    <script>
    async function login() {
        // Đảm bảo API_BASE đã được định nghĩa trong main.js
        const email = document.getElementById("email").value;
        const pw = document.getElementById("password").value;

        const res = await fetch(API_BASE + "/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email: email, password: pw })
        });

        const msgElement = document.getElementById("msg");
        msgElement.innerText = ""; // Xóa thông báo cũ

        if (!res.ok) {
            msgElement.innerText = "Sai email hoặc mật khẩu!";
            return;
        }

        const data = await res.json();
        saveToken(data.token);

        // Điều hướng theo Role
        if (data.role === "Admin")
            window.location.href = "products.html";
        else
            window.location.href = "create-order.html";
    }
    </script>
</body>
</html>